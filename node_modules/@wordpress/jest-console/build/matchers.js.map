{"version":3,"names":["_jestMatcherUtils","require","_supportedMatchers","_interopRequireDefault","createErrorMessage","spyInfo","spy","pass","calls","matcherName","methodName","expected","hint","message","map","printReceived","printExpected","matcherHint","getMockName","createSpyInfo","mock","JSON","stringify","includes","length","createToHaveBeenCalledMatcher","received","assertionsNumber","createToHaveBeenCalledWith","expect","extend","Object","entries","supportedMatchers","reduce","result","matcherNameWith"],"sources":["@wordpress/jest-console/src/matchers.ts"],"sourcesContent":["/**\n * External dependencies\n */\nimport { matcherHint, printExpected, printReceived } from 'jest-matcher-utils';\n\n/**\n * Internal dependencies\n */\nimport supportedMatchers from './supported-matchers';\nimport type { Mock } from 'jest-mock';\nimport type {\n\tExtendedMock,\n\tMatcherFunction,\n\tMatcherResult,\n\tMatcherWithArgsFunction,\n} from './types';\n\ninterface SpyInfo {\n\tspy: Mock;\n\tpass: boolean;\n\tcalls: unknown[][];\n\tmatcherName: string;\n\tmethodName: string;\n\texpected?: unknown[];\n}\n\nconst createErrorMessage = ( spyInfo: SpyInfo ) => {\n\tconst { spy, pass, calls, matcherName, methodName, expected } = spyInfo;\n\tconst hint = pass ? `.not${ matcherName }` : matcherName;\n\tconst message = pass\n\t\t? `Expected mock function not to be called but it was called with:\\n${ calls.map(\n\t\t\t\tprintReceived\n\t\t  ) }`\n\t\t: `Expected mock function to be called${\n\t\t\t\texpected ? ` with:\\n${ printExpected( expected ) }\\n` : '.'\n\t\t  }\\nbut it was called with:\\n${ calls.map( printReceived ) }`;\n\n\treturn () =>\n\t\t`${ matcherHint( hint, spy.getMockName() ) }` +\n\t\t'\\n\\n' +\n\t\tmessage +\n\t\t'\\n\\n' +\n\t\t`console.${ methodName }() should not be used unless explicitly expected\\n` +\n\t\t'See https://www.npmjs.com/package/@wordpress/jest-console for details.';\n};\n\nconst createSpyInfo = (\n\tspy: Mock,\n\tmatcherName: string,\n\tmethodName: string,\n\texpected?: unknown[]\n) => {\n\tconst calls = spy.mock.calls;\n\n\tconst pass = expected\n\t\t? JSON.stringify( calls ).includes( JSON.stringify( expected ) )\n\t\t: calls.length > 0;\n\n\tconst message = createErrorMessage( {\n\t\tspy,\n\t\tpass,\n\t\tcalls,\n\t\tmatcherName,\n\t\tmethodName,\n\t\texpected,\n\t} );\n\n\treturn {\n\t\tpass,\n\t\tmessage,\n\t};\n};\n\nconst createToHaveBeenCalledMatcher =\n\t( matcherName: string, methodName: string ) =>\n\t( received: Record< string, Mock > ): MatcherResult => {\n\t\tconst spy = received[ methodName ] as ExtendedMock;\n\t\tconst spyInfo = createSpyInfo( spy, matcherName, methodName );\n\t\tspy.assertionsNumber += 1;\n\t\treturn spyInfo;\n\t};\n\nconst createToHaveBeenCalledWith = (\n\tmatcherName: string,\n\tmethodName: string\n) =>\n\tfunction (\n\t\treceived: Record< string, Mock >,\n\t\t...expected: unknown[]\n\t): MatcherResult {\n\t\tconst spy = received[ methodName ] as ExtendedMock;\n\t\tconst spyInfo = createSpyInfo( spy, matcherName, methodName, expected );\n\t\tspy.assertionsNumber += 1;\n\t\treturn spyInfo;\n\t};\n\ntype MatchersObject = Record<\n\tstring,\n\tMatcherFunction | MatcherWithArgsFunction\n>;\n\nexpect.extend(\n\tObject.entries( supportedMatchers ).reduce< MatchersObject >(\n\t\t( result, [ methodName, matcherName ] ) => {\n\t\t\tconst matcherNameWith = `${ matcherName }With`;\n\n\t\t\treturn {\n\t\t\t\t...result,\n\t\t\t\t[ matcherName ]: createToHaveBeenCalledMatcher(\n\t\t\t\t\t`.${ matcherName }`,\n\t\t\t\t\tmethodName\n\t\t\t\t),\n\t\t\t\t[ matcherNameWith ]: createToHaveBeenCalledWith(\n\t\t\t\t\t`.${ matcherNameWith }`,\n\t\t\t\t\tmethodName\n\t\t\t\t),\n\t\t\t};\n\t\t},\n\t\t{}\n\t)\n);\n"],"mappings":"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","ignoreList":[]}